<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>15 Puzzle</title>
	<link rel="stylesheet" href="15-puzzle.css">

</head>

<body><div>
	<div id="puzzle" class="image"></div>
	<div id="preview" class="image"></div>
	</div>
	<div id="description"></div>
	<div id="controls">
		<button id="solve">LÃ¶sen</button>
		<button id="scramble">Mischen</button>
		<button id="quit">Beenden</button>
		<button id="help">Hilfe</button>
		<button id="prev">&lt;</button>
		<button id="next">&gt;</button>
	</div>

	<script src="15-puzzle.js"></script>
	<script src="../assets/images.json"></script>
	<script>
		const loadJsonFile = require('load-json-file');
		const ipc = require('electron').ipcRenderer
		var aktuellesBild = 0;
		var aktuelleBeschreibung ='';
		var bilder;

		loadJsonFile('assets/images.json').then(json => {
			bilder = json;
			naechstesBild();
		});

		function naechstesBild() {
			aktuellesBild++;
			var neuesBild = aktuellesBild < bilder.length ? aktuellesBild : 0;
			setzeBild(neuesBild);
			setzeBeschreibung(neuesBild);
		}

		function vorhergehendesBild() {
			aktuellesBild--;
			var neuesBild = aktuellesBild > 0 ? aktuellesBild : bilder.length - 1;
			setzeBild(neuesBild);
			setzeBeschreibung(neuesBild);
		}

		function setzeBild(id) {
			aktuellesBild = id;
			var bild = bilder[id].src;			
			var customStyle = document.getElementById('customStyle');
			if (customStyle != null &&  customStyle.parentNode) {
				customStyle.parentNode.removeChild(customStyle);
			}
			customStyle = document.createElement('style');
			customStyle.id = 'customStyle';
			// var attr = document.createAttribute('type');
			// attr.value = 'text/css';
			// customStyle.a(attr); 
			customStyle.innerText = `.image span{background-image: url(${bild});}`;
			var head = document.getElementsByTagName('head');
			head[0].appendChild(customStyle);
		}

		function setzeBeschreibung(id){
			beschreibung = bilder[id].desc;
			var descriptionElement = document.getElementById('description');
			descriptionElement.innerText = beschreibung;

		}


		const btnPrev = document.getElementById('prev');
		btnPrev.addEventListener('click', vorhergehendesBild)

		const btnNext = document.getElementById('next');
		btnNext.addEventListener('click', naechstesBild)

		const btnQuit = document.getElementById('quit')
		btnQuit.addEventListener('click', function (event) {
			console.log('quit');
			ipc.send('quit')
		})

		const btnHelp = document.getElementById('help')
		btnHelp.addEventListener('click', function () {
			const numbers = document.getElementsByClassName('number');
			numbers.forEach(ctrl => {
				ctrl.setAttribute('style', 'opacity:0')
			})
			console.log(numbers.length);
		});
	</script>
</body>

</html>